# Zoom-Multimodal-Chatbot

This is a Zoom Teams Multimodal chatbot that uses Anthropic's Claude for text responses, Black Forest Labs' FLUX API for image generation, and Exa AI for up-to-date info retrieval. It creates a smart multimodal experience in Zoom chats, responding with text, images, or both based on what users need.

## What It Does

The bot works in Zoom Team Chat (both DMs and groups) and:
- Keeps track of conversation context (last 10 messages)
- Figures out if you want text, an image, or both
- Gives you factual info that's current using Exa's search capabilities
- Can combine info with visuals in one response

It's pretty good at understanding what you want even with minimal prompting, and adapts to the flow of conversation.

### API Integrations

I'm using three main APIs:

- **FLUX** (Black Forest Labs): Generates images quickly at 1024x768. Their API is solid and handles the creative side. [FLUX API Documentation](https://api.us1.bfl.ai/scalar)
- **Claude** (Anthropic): Does the heavy lifting for text responses and makes the image prompts way better. [Claude API Documentation](https://docs.anthropic.com/en/api/getting-started)
- **Exa AI**: Pulls in current info so the bot isn't stuck with outdated knowledge. [Exa AI Documentation](https://docs.exa.ai/reference/getting-started)
- **Zoom**: Integrates with Zoom's API for messaging and user interactions. [Zoom API Documentation](https://developers.zoom.us/docs/api/)

## Message Formats

When sending messages to Zoom, the bot can select from various formats based on the content type. The main message formats include:

1. **Text Messages**: 
   - Simple text messages that can include markdown formatting. The bot uses the `is_markdown_support` flag to indicate that the message supports markdown.
   - Example structure:
     ```json
     {
       "head": { "text": "GenZoom Bot" },
       "body": [
         {
           "type": "message",
           "is_markdown_support": true,
           "text": "This is a text message with *bold* and _italic_ formatting."
         }
       ]
     }
     ```

2. **Image Messages**: 
   - Messages that include an image URL. The bot sends a structured message indicating the type as "attachments".
   - Example structure:
     ```json
     {
       "head": { "text": "Generated Image" },
       "body": [
         {
           "type": "attachments",
           "resource_url": "https://example.com/image.jpg",
           "img_url": "https://example.com/image.jpg",
           "information": {
             "title": { "text": "AI-Generated Image" },
             "description": { "text": "This is an image generated by the bot." }
           }
         }
       ]
     }
     ```

3. **Messages with Links**:
   - The bot can also send messages that include hyperlinks. When sending a message with links, the bot formats the text to ensure that the links are clickable in Zoom.
   - Example structure:
     ```json
     {
       "head": { "text": "Useful Resources" },
       "body": [
         {
           "type": "message",
           "is_markdown_support": true,
           "text": "For more information, visit <https://developers.zoom.us/docs/api/chatbot/#tag/chatbot-messages/POST/im/chat/messages|Zoom API Documentation>."
         }
       ]
     }
     ```

4. **Hybrid Messages**: 
   - Messages that combine both text and images in a single response. This allows for richer interactions where users can receive both visual and textual information simultaneously.
   - Example structure:
     ```json
     {
       "head": { "text": "GenZoom Bot" },
       "body": [
         {
           "type": "message",
           "is_markdown_support": true,
           "text": "Here is the image you requested:"
         },
         {
           "type": "attachments",
           "resource_url": "https://example.com/image.jpg",
           "img_url": "https://example.com/image.jpg",
           "information": {
             "title": { "text": "AI-Generated Visualization" },
             "description": { "text": "Based on your request." }
           }
         }
       ]
     }
     ```

For more details on sending messages, refer to the [Zoom Chatbot Messages API](https://developers.zoom.us/docs/api/chatbot/#tag/chatbot-messages/POST/im/chat/messages) and the [Chat App Card Builder Kit](https://zoom.us/account/chatAppcardBuilderKit).

## Setup

### Requirements
- Node.js 16+
- Zoom account
- API keys for FLUX, Anthropic, and Exa AI

### Installation

```bash
git clone https://github.com/ojusave/zoom_multimodal_teams_chatbot.git
cd zoom_multimodal_teams_chatbot
npm install
```

### Config

Make a `.env` file with:
```
ZOOM_CLIENT_ID=your_zoom_client_id
ZOOM_CLIENT_SECRET=your_zoom_client_secret
ZOOM_BOT_JID=your_zoom_bot_jid
FLUX_SECRET_TOKEN=your_flux_secret_token
ANTHROPIC_API_KEY=your_anthropic_api_key
EXA_API_KEY=your_exa_api_key
PORT=4000
```

### Getting API Keys

- **Zoom**: Create a Team Chat app in the [Zoom marketplace](https://marketplace.zoom.us/).
- **FLUX**: Get your token from Black Forest Labs dashboard.
- **Anthropic**: Get your API key from your account.
- **Exa AI**: Grab your key from their dashboard.

### Running It

```bash
npm start
```

It runs on localhost:4000 by default.

Since Zoom needs a public URL for webhooks, you'll need ngrok:

```bash
ngrok http 4000
```

Use the https URL it gives you in your Zoom webhook settings.

## How to Use It

In your Zoom chat, you can:

- Ask for info: "Explain quantum physics"
- Request an image: "Generate an image of a cat" 
- Ask current facts: "What are the latest AI developments?"
- Get both: "Tell me about the James Webb telescope and show what it looks like"

The bot remembers context, so "tell me more about it" works as expected. Words like "portrait" or "imagine" tend to trigger image generation.

## How It Works

The main `/chat` endpoint:
- Logs incoming messages (helpful for debugging)
- Tracks conversation context per user
- Uses Claude to figure out what's relevant
- Decides whether to send text, image, Exa search results, or a combo
- Generates the response and sends it back to Zoom

Key functions:
- `callAnthropicAPI()`: Handles context extraction and text generation
- `improvePrompt()`: Makes your prompts better for image gen or search
- `callExaAPI()`: Gets current info from Exa
- `analyzeQueryAndDecideResponse()`: Figures out what type of response you want
- `generateHybridResponse()`: Combines text and images

## User Context Management

The bot keeps track of who's talking to it:
- Stores the last 10 messages per user
- Cleans up inactive contexts after 24 hours
- You can set your name with "my name is [name]" for more personalized responses

## Troubleshooting

- If image generation fails, it falls back to text
- For hybrid responses, if info retrieval fails, it'll still try to generate an image
- The bot knows what date it is, so responses stay relevant

## License

MIT License - do whatever you want with this, just don't blame me if something breaks.

## About

The Zoom Multimodal Chatbot is designed to enhance user interactions within Zoom by providing intelligent responses that can include text, images, or both. It leverages advanced AI technologies to understand user queries and deliver relevant information, making it a versatile tool for communication in Zoom Team Chats.

### Resources
- [Zoom Multimodal Teams Chatbot Repository](https://github.com/ojusave/zoom_multimodal_teams_chatbot)

